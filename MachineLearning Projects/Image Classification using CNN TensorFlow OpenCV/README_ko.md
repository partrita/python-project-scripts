# TensorFlow를 사용한 CNN 이미지 분류

이 가이드는 TensorFlow를 사용하여 CNN 이미지 분류를 탐색하고 배우는 데 도움이 될 것입니다.
이것은 입문용 코드베이스입니다. 더 깊은 지식을 원하시면 [GitHub : DeepLearning-ImageClassification-Toolkit](https://github.com/iSiddharth20/DeepLearning-ImageClassification-Toolkit)을 방문하십시오.

#### 이 코드를 실행하려면 TensorFlow가 필요합니다.
[이](https://www.tensorflow.org/install/pip) 가이드를 사용하여 설치하십시오.
#### 다음 명령을 실행하여 필요한 종속성을 설치했는지 확인하십시오.
pip install -r requirements.txt

## 기능 이해

### 1. 전처리
- 'DATA_DIR' 디렉토리에서 데이터 세트 로드
- 이미지의 전체 경로와 클래스 레이블이 포함된 DataFrame 생성
- (요구 사항에 따라 변경) 계산적으로 효율적인 해상도로 이미지 크기 조정
- (선택 사항이지만 권장) 'image_processing' 함수를 사용하여 이미지에서 가장 큰 객체 추출
    - 더 빠른 결과를 위해 병렬 처리 활용
- 필요한 변경을 위해 원본 이미지와 크기 조정 및 처리된 이미지를 나란히 비교
- 처리된 이미지를 NumPy 배열로 변환하고 Pickle 파일로 내보내기
    - 10개의 무작위 샘플을 통해 내보낸 Pickle 파일이 적절한지 확인
- (선택 사항) 특정 클래스 레이블을 함께 병합
- 데이터 균형을 보장하기 위해 계층화를 사용하여 훈련, 테스트, 검증을 위한 데이터 분할
    - 2개의 무작위 샘플을 통해 분할이 적절한지 확인
- (선택 사항) 편향을 줄이기 위해 데이터에 무작위 오버샘플링 수행
    - 2개의 무작위 샘플을 통해 오버샘플링이 적절한지 확인
- 클래스 레이블의 원-핫 인코딩 수행
- 훈련, 테스트, 검증 데이터 및 원-핫 인코딩은 Pickle 파일로 내보내집니다.

### 2. CNN ResNet50 훈련
- 훈련, 테스트, 검증 데이터 및 원-핫 인코딩 가져오기
    - 모든 데이터는 TensorFlow 형식으로 변환됩니다.
- 학습률 스케줄러가 정의됨(원하는 경우 변경)
- 모멘텀이 있는 확률적 경사 하강법이 옵티마이저로 사용됨(원하는 경우 변경)
- 모델 학습을 개선하기 위해 데이터 증강 기술 추가(원하는 경우 변경)
- 기본 모델(CNN ResNet50)은 TensorFlow 라이브러리에서 로드됨
    - 구조에 대한 사용자 지정 최적 변경이 이루어졌습니다.
    - 최종 모델이 컴파일됨
- 최종 모델이 훈련됨
    - 검증 손실이 가장 낮은 최종 모델은 '.h5' 파일로 내보내집니다.
- 훈련 시간(초)이 표시됩니다.

### 3. 검증 및 혼동 행렬
- 훈련된 모델 및 원-핫 인코딩 가져오기
- 전체 데이터 세트는 훈련된 모델을 통해 실행되어 정확도의 실제 값을 얻습니다.
- (선택 사항) 잘못 분류된 이미지 파일은 감지된 클래스 레이블과 함께 별도의 폴더에 복사됩니다.
- 실제 분류 혼동 행렬이 생성됨
    - (선택 사항) 혼동 행렬은 '.png' 파일로 내보낼 수 있습니다.

### 도우미 함수
- 화면에 2개의 이미지를 나란히 표시하는 기능
- 소스 이미지에서 가장 큰 객체를 추출하는 기능
